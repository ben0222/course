### 一个退休的工程师有250000美元用于投资，她每周意用5小时的时间来管理自己的投资，市政债券每年有6%的收益而且不需要管理，房地产投资预计每年可增值8%，每100000美元的投资需要1小时的管理时间，蓝筹股每年可获利10%，需要1.5小时的管理时间，后保债券可获利12%，需要2.5小时的管理时间，谷物期货可获利15%，每100000美元的投资需要5小时的管理时间.
### (a)这个退休工程师应如何投资以获得最高的预期收益?采用五步方法，按线性规划模型求解、
### (b)求每个约束的影子价格:针对本问题解释每个影子价格的含义(c)这个退休工程师从互联网上下载了软件，使她可以对每100000美元的期货投资每周只用3小时的时间有效地管理，这个变化会对(a)和(b)的结果有什么影响?
### (d)在经过期货市场的几次损失之后，工程师认定风险是她的投资策略的一个重要因素.一本投资自助书将市政债券、房地产投资、蓝筹股、后保债券及谷物期货的风险因子分别列为:1、4、3、6和10.工程师决定她投资的平均风险因子不能超过4.这个变化会对(a)和(b)的结果有什么影响?
---
#### 符号说明
$$
\begin{array}
{c}
\hline
	符号 & 说明 & 单位      \\
\hline
    x_1 & 市政债券 & 美元   \\
    x_2 & 房地产投资 & 美元 \\
    x_3 & 蓝筹股 & 美元       \\	              
    x_4 & 后保债券 & 美元   \\	              
    x_5 & 谷物期货 & 美元   \\	              
    W & 预期收益 & 美元     \\	                   
\hline	          
\end{array}
$$  


#### 模型假设
- 除市政债券外的其他投资，每投资 100000 美元需要的管理时间不变；
- 每个项投资的管理时间不一定是其每 100000 美元所需管理时间的整数倍；

#### 模型建立
##### 问题a
由题目要求，本题适用于线性规划模型。以$x_1$市政债券，$x_2$房地产投资，$x_3$蓝筹股，$x_4$后保债券，$x_5$谷物期货为决策变量；以预期收益$W$最大化为目标函数：
\[
    \max W = 0.06x_1 + 0.08x_2 + 0.10x_3 + 0.12x_4 + 0.14x_5
\]
以总投资额不超过$250,000$美元、每周管理时间不超过5小时，和投资不能为负为约束条件：
\[
    s.t.        
\begin{cases}
    x_1+ x_2+ x_3 + x_4 + x_5 \leq 250,000 \\
    \frac{x_2}{100,000} + \frac{1.5x_3}{100,000} + \frac{2.5x_4}{100,000} + \frac{5x_5}{100,000} \leq 5 \\
    x_1 \geq 0\\ 
    x_2 \geq 0\\
    x_3 \geq 0\\
    x_4 \geq 0\\
    x_5 \geq 0\\        
\end{cases}
\]
##### 问题b
由问题一可知约束条件。
- 对于总投资限制，其影子价格表示如果可以额外投入$1$美元而不改变其他约束条件，目标函数值最多可以增加多少；
- 对于管理时间限制，其影子价格表示如果每周可以多投入$1$小时管理时间而不改变其他约束条件，目标函数值最多可以增加多少。
##### 问题c
将谷物期货每 100000 美元的投资所需的管理时间改为 $3$ 小时，按照问题a和b的方法重新建立模型，进行求解。新的约束条件为：
\[
    s.t.        
\begin{cases}
    x_1+ x_2+ x_3 + x_4 + x_5 \leq 250,000 \\
    \frac{x_2}{100,000} + \frac{1.5x_3}{100,000} + \frac{2.5x_4}{100,000} + \frac{3x_5}{100,000} \leq 5 \\
    x_1 \geq 0\\ 
    x_2 \geq 0\\
    x_3 \geq 0\\
    x_4 \geq 0\\
    x_5 \geq 0\\        
\end{cases}
\]
##### 问题d
新增投资组合的平均风险因子不得超过 4 的约束条件。决策变量和目标函数不变。按照问题a和b的方法重新建立模型，进行求解。新的约束条件为：
\[
    s.t.        
\begin{cases}
    x_1+ x_2+ x_3 + x_4 + x_5 \leq 250,000 \\
    \frac{x_2}{100,000} + \frac{1.5x_3}{100,000} + \frac{2.5x_4}{100,000} + \frac{5x_5}{100,000} \leq 5 \\
    x_1 \geq 0\\ 
    x_2 \geq 0\\
    x_3 \geq 0\\
    x_4 \geq 0\\
    x_5 \geq 0\\    
    \frac{1 \times x_1 + 4 \times x_2 + 3 \times x_3 + 6 * x_4 + 10 * x_5}{250,000} \leq 4    
\end{cases}
\]
#### 模型求解
##### 问题a
使用Python中的线性规划库来求解这个问题。
```python
from scipy.optimize import linprog

# 定义目标函数系数
c = [-0.06, -0.08, -0.10, -0.12, -0.14]  # 注意这里是最小化，所以系数要取负号

# 定义不等式约束的系数矩阵
A = [[1, 1, 1, 1, 1], 
     [0, 1/100000, 1.5/100000, 2.5/100000, 5/100000]]

# 定义不等式约束的右侧值
b = [250000, 5]

# 定义变量的边界
x0_bounds = (0, None)
x1_bounds = (0, None)
x2_bounds = (0, None)
x3_bounds = (0, None)
x4_bounds = (0, None)

# 调用线性规划求解函数
res = linprog(c, A_ub=A, b_ub=b, bounds=[x0_bounds, x1_bounds, x2_bounds, x3_bounds, x4_bounds], method='highs')

# 输出结果
print('最大化预期收益为: ${:,.2f}'.format(-res.fun))  # 注意取负号
print('市政债券投资额: ${:,.2f}'.format(res.x[0]))
print('房地产投资额: ${:,.2f}'.format(res.x[1]))
print('蓝筹股投资额: ${:,.2f}'.format(res.x[2]))
print('后保债券投资额: ${:,.2f}'.format(res.x[3]))
print('谷物期货投资额: ${:,.2f}'.format(res.x[4]))

```
得出的结果：
$$
\begin{array}
{c}
\hline
	符号 & 说明 & 预期收益取最大值时的值（单位：美元）      \\
\hline
    x_1 & 市政债券 & 0.00   \\
    x_2 & 房地产投资 & 0.00 \\
    x_3 & 蓝筹股 & 125000.00       \\	              
    x_4 & 后保债券 & 125000.00   \\	              
    x_5 & 谷物期货 & 0.00   \\	              
    W & 预期收益 & 27500.00     \\	                   
\hline	          
\end{array}
$$  
##### 问题b
使用Python中的线性规划库来求解这个问题。
```python
from scipy.optimize import linprog

# 定义对偶问题的目标函数系数
c_dual = [250000, 5]  # 对应总投资限制和管理时间限制的右侧值

# 定义对偶问题的不等式约束系数矩阵的转置
A_dual = [[-0.06, -0.08, -0.10, -0.12, -0.14], 
          [1/100000, 0],
          [1.5/100000, 0],
          [2.5/100000, 0],
          [5/100000, 0]]

# 定义对偶问题的不等式约束的右侧值
b_dual = [-1, -1, -1, -1, -1]  # 对应每个决策变量的系数

# 调用线性规划求解函数
res_dual = linprog(c_dual, A_eq=None, b_eq=None, A_ub=A_dual, b_ub=b_dual, bounds=None, method='highs')

# 输出结果
print('总投资限制的影子价格为: ${:,.2f}'.format(-res_dual.x[0]))  # 注意取负号
print('管理时间限制的影子价格为: ${:,.2f}'.format(-res_dual.x[1]))  # 注意取负号

```
得出的结果：
$$
\begin{array}
{c}
\hline
	约束条件 & 影子价格 \\
\hline
    总投资额 & 0.07   \\
    管理时间 & 2000.00 \\           
\hline	          
\end{array}
$$  

##### 问题c
得出的结果：
$$
\begin{array}
{c}
\hline
	符号 & 说明 & 预期收益取最大值时的值（单位：美元）      \\
\hline
    x_1 & 市政债券 & 83333.33   \\
    x_2 & 房地产投资 & 0.00 \\
    x_3 & 蓝筹股 & 0.00       \\	              
    x_4 & 后保债券 & 0.00   \\	              
    x_5 & 谷物期货 & 166666.67  \\	              
    W & 预期收益 & 30000.00     \\	                   
\hline	          
\end{array}
$$  

$$
\begin{array}
{c}
\hline
	约束条件 & 影子价格 \\
\hline
    总投资额 & 0.06   \\
    管理时间 & 3000.00 \\           
\hline	
\end{array}
$$

##### 问题d
得出的结果：
$$
\begin{array}
{c}
\hline
	符号 & 说明 & 预期收益取最大值时的值（单位：美元）      \\
\hline
    x_1 & 市政债券 & 0.00   \\
    x_2 & 房地产投资 & 0.00 \\
    x_3 & 蓝筹股 & 214285.71       \\	              
    x_4 & 后保债券 & 0.00   \\	              
    x_5 & 谷物期货 & 35714.29  \\	              
    W & 预期收益 & 26785.71     \\	                   
\hline	          
\end{array}
$$  

$$
\begin{array}
{c}
\hline
	约束条件 & 影子价格 \\
\hline
    总投资额 & 0.06   \\
    管理时间 & 0.00 \\           
    平均风险因子 & 1785.71 \\
\hline	
\end{array}
$$


